package com.putable.tilenet.Util;

import java.util.concurrent.BlockingQueue;

import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

import com.putable.tilenet.Util.XMLTags.XMLTag;
import com.putable.tilenet.Util.XMLTags.XMLTag.TagType;

public class TileNetHandler extends DefaultHandler {

    private BlockingQueue<XMLTag> eventQ;

    public TileNetHandler(BlockingQueue<XMLTag> bq) {
	this.eventQ = bq;
    }

    public void startDocument() throws SAXException {
	System.out.println("XML parsing initiated.");
    }

    public void endDocument() throws SAXException {
	System.out.println("XML parsing complete.");
    }

    public void startElement(String uri, String localName, String qName,
	    Attributes atts) throws SAXException {

	if (qName.contains("-"))
	    qName = loggFix(qName);

	qName = qName.toUpperCase();

	eventQ.add(XMLTag.makeTag(TagType.valueOf(qName), atts));

    }

    public void endElement() throws SAXException {
	// TODO : End element will be Important for the xrequests and xresponses
    }

    private String loggFix(String name) {
	return "logged" + name.substring(7);
    }
}
